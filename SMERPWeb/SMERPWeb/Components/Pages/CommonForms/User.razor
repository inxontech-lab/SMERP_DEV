@page "/User"

<PageTitle>User Management</PageTitle>

<RadzenRow Gap="1rem">
    <RadzenColumn Size="12">
        <RadzenCard>
            <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.SpaceBetween" AlignItems="AlignItems.Center" class="rz-mb-3">
                <RadzenText Text="Users" TextStyle="TextStyle.H5" />
                <RadzenButton Text="New User" Icon="add_circle" Click="OpenCreateDialogAsync" ButtonStyle="ButtonStyle.Light" />
            </RadzenStack>

            <RadzenDataGrid Data="Users" TItem="Domain.SaasReqDTO.UserWithRoleResponse" AllowPaging="true" AllowFiltering="true" PageSize="10" EmptyText="No users found.">
                <Columns>
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Property="UserId" Title="ID" Width="80px" />
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Property="TenantId" Title="Tenant ID" Width="110px" />
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Title="Tenant">
                        <Template Context="item">@GetTenantName(item.TenantId)</Template>
                    </RadzenDataGridColumn>
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Property="Username" Title="Username" />
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Property="DisplayName" Title="Display Name" />
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Property="Email" Title="Email" />
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Property="Mobile" Title="Mobile" />
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Property="RoleName" Title="Role" />
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Property="IsActive" Title="Active" Width="100px" />
                    <RadzenDataGridColumn TItem="Domain.SaasReqDTO.UserWithRoleResponse" Title="Actions" Width="180px">
                        <Template Context="item">
                            <RadzenButton Icon="edit" Size="ButtonSize.Small" Click="@(() => OpenEditDialogAsync(item))" class="rz-mr-2" />
                            <RadzenButton Icon="delete" Size="ButtonSize.Small" ButtonStyle="ButtonStyle.Danger" Click="@(() => DeleteAsync(item.UserId))" />
                        </Template>
                    </RadzenDataGridColumn>
                </Columns>
            </RadzenDataGrid>

            @if (!string.IsNullOrWhiteSpace(ErrorMessage))
            {
                <RadzenAlert AlertStyle="AlertStyle.Danger" class="rz-mt-3">@ErrorMessage</RadzenAlert>
            }

            @if (!string.IsNullOrWhiteSpace(SuccessMessage))
            {
                <RadzenAlert AlertStyle="AlertStyle.Success" class="rz-mt-3">@SuccessMessage</RadzenAlert>
            }
        </RadzenCard>
    </RadzenColumn>
</RadzenRow>
